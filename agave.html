<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="img/agave.png" type="image/png" sizes="16x16">
    <title>agave</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify-css.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify-html.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono&display=swap" rel="stylesheet">

    <style>
        body {
                font-family: 'Space Mono', monospace;
            }
        h1,h2,h3,h4,h5,h6 {
            font-family: 'Space Mono', monospace;
        }
        p {
            font-family: 'Space Mono', monospace;
        }
        .scroll{
            position:fixed;
            width:60px;
            height:60px;
            bottom:80px;
            right:25%;
            left:50%;
            margin: -30px;
            background-color:#0C9;
            color:#FFF;
            border-radius:50px;
            text-align:center;
            box-shadow: 2px 2px 3px #999;
            text-decoration: none;
        }
        .scroll:hover{
            color:#FFF;
        }
    </style>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q0BWVH4C4T"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-Q0BWVH4C4T');
    </script>
</head>
<body>
    <nav class="navbar navbar-light my-2">
        <div class="container-fluid">
            <a class="navbar-brand">
                <img class="d-inline-block align-text-top" src="img/agave.png" width="28" height="28">
                {"agave": <span class="text-muted">"pretty print kibana logs."</span>}
            </a>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <div class="col" style="overflow-x: auto;">
                <form action="">
                    <div class="input-group mb-3">
                        <textarea class="form-control" name="" id="theString" rows="4" style="font-size: 11pt"></textarea>
                    </div>
                    <div class="mb-3">
                        <input class="btn btn-outline-dark me-1" type="submit" name="" id="" onclick="prettyPrint();" value="pretty print">
                        <input class="btn btn-light" type="submit" name="" id="" onclick="clean();" value="clean">
                    </div>
                </form>

                <div class="mt-4 border-start border-3 px-2">
                    <pre id="output"></pre>
                </div>
            </div>

            <div class="col">
                <form action="">
                    <div class="input-group mb-3">
                        <textarea class="form-control" name="" id="jsonString" rows="4" style="font-size: 11pt"></textarea>
                    </div>
                    <div class="mb-3">
                        <input class="btn btn-outline-dark me-1" type="submit" name="" id="" onclick="jsonPrint();" value="json print">
                        <input class="btn btn-light" type="submit" name="" id="" onclick="jsonClean();" value="clean">
                    </div>
                </form>

                <div class="mt-4 border-start border-3 px-2">
                    <pre id="json_output"></pre>
                </div>
            </div>

            <div class="my-1">
                <p class="text-center">agave for kibana logs. isaac benitez. 2021.</p>
            </div>

            <a href="#" class="scroll">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="36" height="36" preserveAspectRatio="xMidYMid meet" viewBox="0.5 -7.5 24 24"><rect x="0" y="0" width="36" height="" fill="none" stroke="none" />
                    <path d="M13 5.586l-4.707 4.707a.999.999 0 1 0 1.414 1.414L12 9.414V17a1 1 0 1 0 2 0V9.414l2.293 2.293a.997.997 0 0 0 1.414 0a.999.999 0 0 0 0-1.414L13 5.586z" fill="white"/>
                </svg>
            </a>
        </div>
    </div>

</body>

<script>

    function clean(){
        event.preventDefault();
        document.getElementById('theString').value = "";
        document.getElementById('output').innerHTML = "";
    }

    function jsonClean(){
        event.preventDefault();
        document.getElementById('jsonString').value = "";
        document.getElementById('json_output').innerHTML = "";
    }

    function prettyPrint() {

        event.preventDefault();
    
        let inputStr = document.getElementById('theString').value;

        // https://github.com/beautify-web/js-beautify
        var beautify = window.js_beautify;
        document.getElementById('output').innerHTML = beautify(inputStr, { indent_size: 2, space_in_empty_paren: true });
    }

    function jsonPrint(){
        event.preventDefault();
    
        let inputStr = document.getElementById('jsonString').value;
        
        // relace single quotes with double quotes
        let doubleStr = inputStr.replaceAll('\'', '\"');

        // remove quotes for arrays
        let arrStr = doubleStr.replaceAll('\"\[', '\[');
        arrStr = arrStr.replaceAll('\]\"', '\]');

        const regex1 = /([{,]\s*)([^"':}]+)(\s*:)/g;
        const subst1 = `$1"$2"$3`;

        let quotesAddedStr = arrStr.replace(regex1, subst1);
        let result1 = quotesAddedStr.replaceAll('{"}', '{}');
        console.log(result1);
        
        try {
            let jsonObj = JSON.parse(String(result1));
            document.getElementById('json_output').innerHTML = JSON.stringify(jsonObj, null, 2);
        } catch(e) {
            document.getElementById('json_output').innerHTML = e;
        }
    }

    
    window.scroll({
        top: 0,
        left: 0,
        behavior: 'smooth'
    });
    
</script>
</html>

